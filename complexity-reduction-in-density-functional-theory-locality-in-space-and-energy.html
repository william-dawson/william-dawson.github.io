<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Complexity Reduction in Density Functional Theory: Locality in Space and Energy &ndash; william-dawson.github.io</title>

    <!-- Meta -->
    <meta name="description" content="william-dawson.github.io &ndash; ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Social -->
    <meta property="article:author" content="William Dawson" />
    <meta property="article:section" content="Lessons" />
    <meta property="article:published_time" content="2023-04-28" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Complexity Reduction in Density Functional Theory: Locality in Space and Energy"/>
    <meta property="og:description" content="I announce a publication I worked on in our series on Complexity Reduction. I provide a teaser for the paper results using a magic trick related to eigenvalues."/>
    <meta property="og:site_name" content="william-dawson.github.io" />
    <meta property="og:url" content="https://william-dawson.github.io/complexity-reduction-in-density-functional-theory-locality-in-space-and-energy.html"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Complexity Reduction in Density Functional Theory: Locality in Space and Energy">
    <meta name="twitter:description" content="I announce a publication I worked on in our series on Complexity Reduction. I provide a teaser for the paper results using a magic trick related to eigenvalues.">
    <meta name="twitter:url" content="https://william-dawson.github.io/complexity-reduction-in-density-functional-theory-locality-in-space-and-energy.html">

    <!-- Feed -->
    <link rel="alternate" type="application/atom+xml" href="https://william-dawson.github.io/feeds/all.atom.xml" title="william-dawson.github.io Atom Feed" />

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/pygments-highlight-github.css">

    <!-- Icon -->

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://william-dawson.github.io/theme/js/jqcloud.min.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>

  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="https://william-dawson.github.io" id="header-logo" title="Home">WD</a>
        <nav id="header-menu">
          <ul>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/about.html">About</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/projects.html">Projects</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/publications.html">Publications</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/lessons.html">Lessons</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/personal-blog.html">Personal Blog</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Complexity Reduction in Density Functional Theory: Locality in Space and Energy</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2023-04-28T11:00:00+09:00">Fri 28 April 2023</time> in <a href="https://william-dawson.github.io/category/lessons.html" title="All articles in category Lessons">Lessons</a></span>
          </div>
          <div>
            <span class="w3-tag w3-light-grey w3-text-green w3-hover-green">
              <a href="https://william-dawson.github.io/tag/publication.html" title="All articles with Publication tag">#publication</a>
            </span>
          </div>
        </div>
      </header>

      <br>


      <div class="col-main w3-container">
        <section id="content">
          <p>I am happy to announce a new paper in our series on Complexity Reduction. The title is <a href="https://doi.org/10.1063/5.0142652">"Complexity Reduction in Density Functional Theory: Locality in Space and Energy"</a>. In this sequence of papers, we've been trying to look at how to perform DFT calculations on large systems, with a focus on how to analyze large systems. In this paper, I incorporated our framework into a code called <a href="https://www.r-ccs.riken.jp/software_center/software/ntchem/overview/">NTChem</a>, which is based on Gaussian orbitals. NTChem has two major benefits over the previous code we integrated it with (BigDFT): hybrid functionals and an all-electron representation. This gave us some new things to explore. </p>
<p>For example: eigenvalues. I write in my papers a lot about how challenging it is to compute the eigenvectors/eigenvalues of large matrices right? Well, let's take a look at something really quick in PySCF.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">scf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span> <span class="o">=</span> <span class="s1">&#39;O         -1.17120        0.29970        0.00000; &#39;</span>
                   <span class="s1">&#39;H         -1.12910        0.83640        0.80990; &#39;</span>
                   <span class="s1">&#39;C         -0.04630       -0.56650        0.00000; &#39;</span>
                   <span class="s1">&#39;H         -0.09580       -1.21200        0.88190; &#39;</span>
                   <span class="s1">&#39;H         -0.09520       -1.19380       -0.89460; &#39;</span>
                   <span class="s1">&#39;H          2.10500       -0.37200       -0.01770; &#39;</span>
                   <span class="s1">&#39;H          1.24260        0.93070       -0.87040; &#39;</span>
                   <span class="s1">&#39;H          1.26160        0.90520        0.88860; &#39;</span>
                   <span class="s1">&#39;C          1.21750        0.26680        0.00000; &#39;</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;STO-3G&#39;</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</code></pre></div>

<p>We will need the Hamiltonian and overlap matrices.</p>
<div class="highlight"><pre><span></span><code><span class="n">S</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">()</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">27.2114</span> <span class="o">*</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_fock</span><span class="p">()</span> <span class="c1"># Convert to eV</span>
</code></pre></div>

<p>We can manually get the eigenvalues of these matrices by calling scipy's eigh.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigh</span>
<span class="n">w</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">S</span><span class="p">)</span>
</code></pre></div>

<p>Now for the fun part. I'm going to print out the Hamiltonian matrix. Look at it closely. Can you guess what is the smallest eigenvalue of this matrix?</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">H</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>-551 -140 -1 0 -1 -31 -0 -14 18 -14 -0 -3 -3 -0 -1 -0 0 -1 2 -0 -0
-140 -67 -2 0 -2 -27 -6 -17 16 -12 -0 -4 -4 -0 -1 -1 -0 -2 3 0 -0
-1 -2 -10 -1 0 -2 -9 -11 5 -8 -0 -3 -3 -0 -1 -1 -0 -2 3 0 -0
0 0 -1 -10 1 -7 7 8 -7 1 0 3 3 0 -0 -0 0 0 -1 -1 -0
-1 -2 0 1 -10 -12 -0 -1 1 -1 -5 -1 1 -0 0 -0 -0 -0 0 0 -1
-31 -27 -2 -7 -12 -15 -3 -7 5 -5 -2 -3 -2 -0 -1 -2 -1 -2 2 -0 -1
-0 -6 -9 7 -0 -3 -302 -81 0 -0 -0 -21 -21 -2 -2 -2 -0 -10 13 9 -0
-14 -17 -11 8 -1 -7 -81 -44 0 -1 -0 -20 -20 -5 -5 -5 -9 -16 13 8 -0
18 16 5 -7 1 5 0 0 -10 -0 0 1 1 -5 -4 -4 -13 -12 5 6 -0
-14 -12 -8 1 -1 -5 -0 -1 -0 -10 -0 7 7 -1 -4 -4 -9 -8 6 -0 -0
-0 -0 -0 0 -5 -2 -0 -0 0 -0 -9 -10 10 0 2 -2 -0 -0 0 0 -4
-3 -4 -3 3 -1 -3 -21 -20 1 7 -10 -13 -7 -2 -1 -2 -2 -5 4 3 -2
-3 -4 -3 3 1 -2 -21 -20 1 7 10 -7 -13 -2 -2 -1 -2 -5 4 3 2
-0 -0 -0 0 -0 -0 -2 -5 -5 -1 0 -2 -2 -13 -7 -7 -21 -20 -10 7 0
-1 -1 -1 -0 0 -1 -2 -5 -4 -4 2 -1 -2 -7 -13 -7 -20 -20 -0 -7 10
-0 -1 -1 -0 -0 -2 -2 -5 -4 -4 -2 -2 -1 -7 -7 -13 -20 -20 -0 -7 -10
0 -0 -0 0 -0 -1 -0 -9 -13 -9 -0 -2 -2 -21 -20 -20 -300 -81 -0 -0 -0
-1 -2 -2 0 -0 -2 -10 -16 -12 -8 -0 -5 -5 -20 -20 -20 -81 -43 1 0 -0
2 3 3 -1 0 2 13 13 5 6 0 4 4 -10 -0 -0 -0 1 -9 -0 0
-0 0 0 -1 0 -0 9 8 6 -0 0 3 3 7 -7 -7 -0 0 -0 -8 0
-0 -0 -0 -0 -1 -1 -0 -0 -0 -0 -4 -2 2 0 10 -10 -0 -0 0 0 -8
</code></pre></div>

<p>Hopefully you didn't start writing some code, or reach for a pen and paper, because the answer is simple.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">diag</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Generalized&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">H</span><span class="p">)),</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Diagonal of H&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (a.u.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IDX&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>

<p><img alt="png" src="https://william-dawson.github.io/assets/cr3/output_9_0.png"></p>
<p>It's just the smallest element on the diagonal. That wasn't so hard was it? </p>
<p>...</p>
<p>Ok, of course, that's not exactly right.</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">H</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="mf">0.23812229157852016</span><span class="w"> </span><span class="n">eV</span>
</code></pre></div>

<p>Can we do better? Using the STO-3G basis set, there are 5 basis functions associated with the Oxygen atom. Let's extract the submatrices associated with those basis functions.</p>
<div class="highlight"><pre><span></span><code><span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">subH</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">subS</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
</code></pre></div>

<p>Next diagonalize those matrices. 3x3 is perfect for pen and paper.</p>
<div class="highlight"><pre><span></span><code><span class="n">ws</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">subH</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">subS</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Generalized&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">H</span><span class="p">)),</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Diagonal of H&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalues of subH&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (a.u.)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IDX&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>

<p><img alt="png" src="https://william-dawson.github.io/assets/cr3/output_16_0.png"></p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="mf">0.026186869587604633</span><span class="w"> </span><span class="n">eV</span>
</code></pre></div>

<p>That's a significant improvement, and we can do even better. The oxygen in Ethanol is bonded to a hydrogen atom (1 basis function) and a carbon atom (5 basis functions), which I carefully put in that order in the atomic structure. What happens if we add the hydrogen to our submatrix? </p>
<div class="highlight"><pre><span></span><code><span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">subH2</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">subS2</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">ws2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">subH2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">subS2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">ws2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="mf">0.011907288253269144</span><span class="w"> </span><span class="n">eV</span>
</code></pre></div>

<p>The carbon?</p>
<div class="highlight"><pre><span></span><code><span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">subH3</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">subS3</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">ws3</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">subH3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">subS3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">ws3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="mf">0.00017517871185646072</span><span class="w"> </span><span class="n">eV</span>
</code></pre></div>

<p>But the order was important, we couldn't take the last carbon, for example.</p>
<div class="highlight"><pre><span></span><code><span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">subH4</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">subS4</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">idx</span><span class="p">]</span>
<span class="n">ws4</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">subH4</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">subS4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">ws4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="mf">0.025714691883194973</span><span class="w"> </span><span class="n">eV</span>
</code></pre></div>

<p>If this is interesting to you, feel free to give our paper a read, where this and related topics are explored. It is part of a JCP Special Topic on <a href="https://pubs.aip.org/jcp/collection/1150/High-Performance-Computing-in-Chemical-Physics">High Performance Computing in Chemical Physics</a> which is sure to be full of great papers.</p>
        </section>

        <br><br><br>

 <!--        <footer>
          <div class="adjust-width">
            <div id="author-block" class="w3-light-grey w3-border">
              <div id="author-info">
                <a href=""><img style="width: 60px; height: 60px;" src="" onerror="this.src='images/avatar.png'" alt="Avatar"></a>
                <div style="margin-left: 20px; margin-top: 15px;">
                  <a href=""><span id="author-name" class="w3-hover-text-dark-grey">William Dawson</span></a>
                  <p id="author-story"></p>
                </div>
              </div>
            </div>
          </div>

          <br><br><br>

          <p style="font-size:10pt; font-style: italic;">Did you like this article? Share it with your friends!</p>
          <div id="share" class="share">
            <a href="http://www.facebook.com/sharer.php?u=https%3A//william-dawson.github.io/complexity-reduction-in-density-functional-theory-locality-in-space-and-energy.html&amp;t=william-dawson.github.io%3A%20Complexity%20Reduction%20in%20Density%20Functional%20Theory%3A%20Locality%20in%20Space%20and%20Energy" target="_blank" class="w3-btn w3-indigo">
              <i class="fa fa-facebook"></i> <span>Facebook</span>
            </a>
            <a href="http://twitter.com/share?url=https%3A//william-dawson.github.io/complexity-reduction-in-density-functional-theory-locality-in-space-and-energy.html&amp;text=william-dawson.github.io%3A%20Complexity%20Reduction%20in%20Density%20Functional%20Theory%3A%20Locality%20in%20Space%20and%20Energy" target="_blank" class="w3-btn w3-blue">
              <i class="fa fa-twitter"></i> <span>Twitter</span>
            </a>
            <a href="https://plus.google.com/share?url=https%3A//william-dawson.github.io/complexity-reduction-in-density-functional-theory-locality-in-space-and-energy.html" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="w3-btn w3-red">
              <i class="fa fa-google-plus"></i> <span>Google</span>
            </a>
          </div>

          <br><br><br>



        </footer> -->
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>&copy;  William Dawson  | <a href="https://william-dawson.github.io/feeds/all.atom.xml">Atom feed <i class="fa fa-rss" aria-hidden="true"></i></a></span>
      </div>
    </footer>



  </body>
</html>