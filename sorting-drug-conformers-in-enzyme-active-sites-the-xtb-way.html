<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Sorting drug conformers in enzyme active sites: the XTB way &ndash; william-dawson.github.io</title>

    <!-- Meta -->
    <meta name="description" content="william-dawson.github.io &ndash; ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Social -->
    <meta property="article:author" content="William Dawson" />
    <meta property="article:section" content="Lessons" />
    <meta property="article:published_time" content="2024-04-19" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Sorting drug conformers in enzyme active sites: the XTB way"/>
    <meta property="og:description" content="I share a new paper I helped write that is about low cost quantum mechanical methods for computing protein-ligand binding."/>
    <meta property="og:site_name" content="william-dawson.github.io" />
    <meta property="og:url" content="https://william-dawson.github.io/sorting-drug-conformers-in-enzyme-active-sites-the-xtb-way.html"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Sorting drug conformers in enzyme active sites: the XTB way">
    <meta name="twitter:description" content="I share a new paper I helped write that is about low cost quantum mechanical methods for computing protein-ligand binding.">
    <meta name="twitter:url" content="https://william-dawson.github.io/sorting-drug-conformers-in-enzyme-active-sites-the-xtb-way.html">

    <!-- Feed -->
    <link rel="alternate" type="application/atom+xml" href="https://william-dawson.github.io/feeds/all.atom.xml" title="william-dawson.github.io Atom Feed" />

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/pygments-highlight-github.css">

    <!-- Icon -->

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://william-dawson.github.io/theme/js/jqcloud.min.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>

  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="https://william-dawson.github.io" id="header-logo" title="Home">WD</a>
        <nav id="header-menu">
          <ul>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/about.html">About</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/projects.html">Projects</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/publications.html">Publications</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/lessons.html">Lessons</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/personal-blog.html">Personal Blog</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Sorting drug conformers in enzyme active sites: the XTB way</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2024-04-19T11:00:00+09:00">Fri 19 April 2024</time> in <a href="https://william-dawson.github.io/category/lessons.html" title="All articles in category Lessons">Lessons</a></span>
          </div>
          <div>
            <span class="w3-tag w3-light-grey w3-text-green w3-hover-green">
              <a href="https://william-dawson.github.io/tag/publication.html" title="All articles with Publication tag">#publication</a>
            </span>
          </div>
        </div>
      </header>

      <br>


      <div class="col-main w3-container">
        <section id="content">
          <p>I have another paper I'd like to share with you that I helped write: <a href="https://doi.org/10.1039/D4CP00930D">Sorting drug conformers in enzyme active sites: the XTB way</a>. The genesis of this paper was that we wanted to try applying quantum chemistry calculations to drug design. We came up with a few interesting targets and got started on our calculations. However, quickly we became concerned about how accurate our methods really were, and how much uncertainty we should expect with respect to experiment. For better of for worse, that got us sidetracked into running more and more benchmarks on systems that looked like our target. These benchmark results are the theme of the paper.</p>
<p>We were very happy to find that the GFN semi-empirical methods available in the <a href="https://xtb-docs.readthedocs.io/en/latest/">XTB Program</a> provided a great balance of accuracy and cost. Of course, these methods have already been evaluated by the people who proposed them and some other groups, but I hope that our results can widen the scope of the evidence, and provide an extra layer of confidence. If you are familiar with the basics of quantum chemistry, I highly recommend you install XTB and try it out on your systems.</p>
<h2>Example</h2>
<p>Let me provide you a brief illustration of the utility of the GFN methods. Recently I saw <a href="https://doi.org/10.1021/acs.jctc.3c01293">a paper published in JCTC</a> that is about the molecules-in-molecules fragment approach. Their focus was on benchmarking fragmentation approaches, but as a side effect they have some useful reference data for us. In their supplementary information there are some benchmarks related to cyclin-dependent kinase 2; the benchmarks include interaction energies computed with three different methods: DLPNO-MP2 cc-pVTZ, DLPNO-MP2 TightPNO def2-TZVP, and DLPNO-CCSD(T) def2-TZVP. Of course, there are various approximations at work here, but let's take their DLPNO-CCSD(T) def2-TZVP value as a benchmark, and see how the other methods compare. I was a little discouraged by the PDF form of the benchmark, but actually ChatGPT was able to extract it for pasting into excel.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_excel</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;data.xlsx&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;list&quot;</span><span class="p">)</span>
</code></pre></div>

<p>I've downloaded as well the XYZ files they have provided, so it's a simple matter of looping and computing. We can try out the different GFN methods as we go. I'm going to use our <a href="https://l_sim.gitlab.io/remotemanager/index.html">remotemanager library</a> to run this, even though I'm running on my laptop, because it makes it easy to cache the results (so that I can restart my notebook without having to run everything all over again).</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">gfn</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">subprocess</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">gfn</span><span class="si">}</span><span class="s2">.out&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;ulimit -s hard ; &quot;</span>
    <span class="n">cmd</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;xtb --iterations 5000 </span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s1">.xyz --</span><span class="si">{</span><span class="n">gfn</span><span class="si">}</span><span class="s1"> | tee </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">cmd</span> <span class="o">+=</span> <span class="s1">&#39;| grep &quot;TOTAL ENERGY&quot; | &#39;</span> <span class="o">+</span> <span class="s2">&quot;awk &#39;{print $4}&#39;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
                            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">remotemanager</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">compute</span><span class="p">,</span> <span class="n">extra_files_send</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CDK2_dataset/*&quot;</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">gfn</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;gfn2&quot;</span><span class="p">,</span> <span class="s2">&quot;gfn1&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Molecule ID&quot;</span><span class="p">]:</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">append_run</span><span class="p">({</span><span class="s2">&quot;mol&quot;</span><span class="p">:</span> <span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;gfn&quot;</span><span class="p">:</span> <span class="n">gfn</span><span class="p">},</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="p">;</span> <span class="n">ds</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="p">;</span> <span class="n">ds</span><span class="o">.</span><span class="n">fetch_results</span><span class="p">()</span>
</code></pre></div>

<p>Put the data back in the table.</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gfn2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;gfn1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">runner</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">runners</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="n">runner</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s2">&quot;gfn&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>

<p>Now transform this data so we get the three point interaction energies.</p>
<div class="highlight"><pre><span></span><code><span class="n">base</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Molecule ID&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;Lig&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
<span class="n">ie</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">base</span><span class="p">}</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
    <span class="n">ab</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Molecule ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Molecule ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="s1">&#39;_LigOnly&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Molecule ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="s1">&#39;_NoLig&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;Molecule ID&#39;</span><span class="p">:</span>
            <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">ab</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">b</span><span class="p">])</span>
            <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">2625.5002</span>  <span class="c1"># kJ/mol</span>
</code></pre></div>

<p>Let's create a box plot with the different errors.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="s2">&quot;DLPNO-CCSD(T) def2-TZVP&quot;</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">ref</span><span class="p">:</span>
            <span class="n">errors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">ref</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">errors</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error (kJ/mol)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Box Plot" src="https://william-dawson.github.io/assets/sort/output_11_0.png"></p>
<p>The box plot shows that XTB is performing very well despite being substantially cheaper than the MP2 comparison. GFN1 is so close, one might want to check if it very similar data was included in the original fitting. Relative energies are also an important benchmark though (and remove any constant under / overbinding trend), so let's plot some correlations:</p>
<div class="highlight"><pre><span></span><code><span class="n">plot_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">method</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[]}</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">ie</span><span class="p">[</span><span class="n">base</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="n">ref</span><span class="p">}</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
    <span class="n">ref_value</span> <span class="o">=</span> <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">ref</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="n">ref</span><span class="p">:</span>
            <span class="n">plot_data</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_value</span><span class="p">)</span>
            <span class="n">plot_data</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ie</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">method</span><span class="p">])</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

    <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">best_fit_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">best_fit_line</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

    <span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">best_fit_line</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">r_squared</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="se">\n</span><span class="s2">$R^2 = </span><span class="si">{</span><span class="n">r_squared</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Computed&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Correlation Plot" src="https://william-dawson.github.io/assets/sort/output_13_0.png"></p>
<p>Now we see better the close agreement between MP2 and the reference result. Yet, we shouldn't let this distract us from the remarkable performance of XTB. From looking at the plots, you can definitely imagine deploying XTB over some big datasets to whittle down your focus. Surprisingly, we get better results for the older GFN-1 than GFN-2, which was also true in the paper. For your study, you should definitely try both out to find what works best for you.</p>
<h2>Spring 2024</h2>
<p>The 2024 cherry blossom season has come and gone here in Japan. Recently, I took a day off to visit Marugame city in Kagawa prefecture. I definitely recommend this city to anyone traveling in the area. This city is famous for Udon... in fact we ate it three times in one day! It also has the beautiful remains of a castle right in the center of the city. I took the below picture from the top, enjoying the view of cherry blossoms and a rather unusally shaped mountain.</p>
<p><img alt="The view from atop Marugame castle" src="https://william-dawson.github.io/assets/sort/maru.jpg"></p>
        </section>

        <br><br><br>

 <!--        <footer>
          <div class="adjust-width">
            <div id="author-block" class="w3-light-grey w3-border">
              <div id="author-info">
                <a href=""><img style="width: 60px; height: 60px;" src="" onerror="this.src='images/avatar.png'" alt="Avatar"></a>
                <div style="margin-left: 20px; margin-top: 15px;">
                  <a href=""><span id="author-name" class="w3-hover-text-dark-grey">William Dawson</span></a>
                  <p id="author-story"></p>
                </div>
              </div>
            </div>
          </div>

          <br><br><br>

          <p style="font-size:10pt; font-style: italic;">Did you like this article? Share it with your friends!</p>
          <div id="share" class="share">
            <a href="http://www.facebook.com/sharer.php?u=https%3A//william-dawson.github.io/sorting-drug-conformers-in-enzyme-active-sites-the-xtb-way.html&amp;t=william-dawson.github.io%3A%20Sorting%20drug%20conformers%20in%20enzyme%20active%20sites%3A%20the%20XTB%20way" target="_blank" class="w3-btn w3-indigo">
              <i class="fa fa-facebook"></i> <span>Facebook</span>
            </a>
            <a href="http://twitter.com/share?url=https%3A//william-dawson.github.io/sorting-drug-conformers-in-enzyme-active-sites-the-xtb-way.html&amp;text=william-dawson.github.io%3A%20Sorting%20drug%20conformers%20in%20enzyme%20active%20sites%3A%20the%20XTB%20way" target="_blank" class="w3-btn w3-blue">
              <i class="fa fa-twitter"></i> <span>Twitter</span>
            </a>
            <a href="https://plus.google.com/share?url=https%3A//william-dawson.github.io/sorting-drug-conformers-in-enzyme-active-sites-the-xtb-way.html" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="w3-btn w3-red">
              <i class="fa fa-google-plus"></i> <span>Google</span>
            </a>
          </div>

          <br><br><br>



        </footer> -->
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>&copy;  William Dawson  | <a href="https://william-dawson.github.io/feeds/all.atom.xml">Atom feed <i class="fa fa-rss" aria-hidden="true"></i></a></span>
      </div>
    </footer>



  </body>
</html>