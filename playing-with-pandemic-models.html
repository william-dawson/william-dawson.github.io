<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Playing with Pandemic Models &ndash; william-dawson.github.io</title>

    <!-- Meta -->
    <meta name="description" content="william-dawson.github.io &ndash; ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Social -->
    <meta property="article:author" content="William Dawson" />
    <meta property="article:section" content="Lessons" />
    <meta property="article:published_time" content="2020-05-16" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Playing with Pandemic Models"/>
    <meta property="og:description" content="The ongoing COVID-19 pandemic provides some opportunity to explore discrete event modelling with python."/>
    <meta property="og:site_name" content="william-dawson.github.io" />
    <meta property="og:url" content="https://william-dawson.github.io/playing-with-pandemic-models.html"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Playing with Pandemic Models">
    <meta name="twitter:description" content="The ongoing COVID-19 pandemic provides some opportunity to explore discrete event modelling with python.">
    <meta name="twitter:url" content="https://william-dawson.github.io/playing-with-pandemic-models.html">

    <!-- Feed -->
    <link rel="alternate" type="application/atom+xml" href="https://william-dawson.github.io/feeds/all.atom.xml" title="william-dawson.github.io Atom Feed" />

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://william-dawson.github.io/theme/css/pygments-highlight-github.css">

    <!-- Icon -->

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://william-dawson.github.io/theme/js/jqcloud.min.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>

  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="https://william-dawson.github.io" id="header-logo" title="Home">WD</a>
        <nav id="header-menu">
          <ul>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/about.html">About</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/projects.html">Projects</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/pages/publications.html">Publications</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/lessons.html">Lessons</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="https://william-dawson.github.io/category/personal-blog.html">Personal Blog</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Playing with Pandemic Models</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2020-05-16T11:00:00+09:00">Sat 16 May 2020</time> in <a href="https://william-dawson.github.io/category/lessons.html" title="All articles in category Lessons">Lessons</a></span>
          </div>
          <div>
            <span class="w3-tag w3-light-grey w3-text-green w3-hover-green">
              <a href="https://william-dawson.github.io/tag/modelling.html" title="All articles with Modelling tag">#modelling</a>
            </span>
          </div>
        </div>
      </header>

      <br>


      <div class="col-main w3-container">
        <section id="content">
          <p>In this topical notebook, I wanted to explore modelling our ongoing pandemic. Recently, there has been some discussion about whether top down lockdown rules are necessary. One counter argument I see is that once the general public is well informed about the virus, we can expect them to reduce social interaction voluntarily. With this in mind, we would like some way to measure whether this reduction is sufficient.</p>
<p>Before starting, I will add the caveat that I know almost nothing about epidemiology. As a result, most of what is presented here is probably wrong, but fun nonetheless. To emphasize this point, we'll use the xkcd plot style:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">()</span>
</code></pre></div>

<p>Let's start with a simple model of the virus. We'll have our model run for 120 days. We're going to use a magic $R_0$ value here, which will simulate the exponential growth behavior we want. Note that this is different than the real value, it is a per day growth factor not the average number any individual spreads it to. We'll start our model with 50 cases.</p>
<div class="highlight"><pre><span></span><code><span class="n">total_days</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">days</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="p">))</span>
<span class="n">r0</span> <span class="o">=</span> <span class="mf">1.10</span>
<span class="n">starting_cases</span> <span class="o">=</span> <span class="mi">50</span>
</code></pre></div>

<p>Now compute and plot the number of infections.</p>
<div class="highlight"><pre><span></span><code><span class="n">cases</span> <span class="o">=</span> <span class="p">[</span><span class="n">starting_cases</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_days</span><span class="p">):</span>
    <span class="n">cases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r0</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cases</span><span class="p">,</span> <span class="s1">&#39;kx--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;New Infections&quot;</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Number of infections" src="https://william-dawson.github.io/assets/pand/output_5_0.png"></p>
<p>Imagine that we implement some sort of policy which changes the $R_0$ value to something new. We'll flip the switch at day 60.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="n">switch</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">rnew</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="n">model1</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rnew</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="s1">&#39;kx--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;New Infections&quot;</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Switch flipped" src="https://william-dawson.github.io/assets/pand/output_7_0.png"></p>
<p>That's looking much better. But we don't want to study the number of cases, because this is very difficult to directly measure. Instead, we will study the number of deaths. In our model, we will assume that everyone who gets sick dies. Now we want to produce a plot of deaths per day. To do so, we need two variables: the average days to die since getting a case, and the standard deviation. Let's pick 20 days as the average, and 3 as the deviation.</p>
<div class="highlight"><pre><span></span><code><span class="n">mean</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">deviation</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

<p>We want to combine this information to predict deaths per day.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_deaths</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
    <span class="n">deaths_per_day</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="o">*</span><span class="mi">2</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">deviation</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">:</span>
            <span class="n">deaths_per_day</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">deaths_per_day</span>
</code></pre></div>

<p>Plot this and see what the shape is.</p>
<div class="highlight"><pre><span></span><code><span class="n">deaths_per_day</span> <span class="o">=</span> <span class="n">compute_deaths</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;kx--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deaths Per Day&quot;</span><span class="p">)</span>

<span class="n">axs2</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">))}</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lockdown&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lockdown+Mean&quot;</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Deaths" src="https://william-dawson.github.io/assets/pand/output_13_0.png"></p>
<p>So in this model, we end up with a peak number of deaths 20 days after the lockdown. Let's consider a second policy, which will correspond to a voluntary lockdown. For this, we'll pick some medium size $R_0$ to switch to.</p>
<div class="highlight"><pre><span></span><code><span class="n">rsoft</span> <span class="o">=</span> <span class="mf">1.05</span>
<span class="n">switch_soft</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">model2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch_soft</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rsoft</span>

<span class="n">deaths_per_day2</span> <span class="o">=</span> <span class="n">compute_deaths</span><span class="p">(</span><span class="n">model2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day2</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;kx--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deaths Per Day&quot;</span><span class="p">)</span>

<span class="n">axs2</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">))}</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft Lockdown&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft Lockdown+Mean&quot;</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
</code></pre></div>

<p><img alt="Voluntary lockdown" src="https://william-dawson.github.io/assets/pand/output_15_0.png"></p>
<p>In fact, with the soft lockdown it is not so easy to see the effect. Now for our real goal. What happens if we do a two staged approach? In the first stage, the public begins hearing that the virus is going around. They start to worry, and begin changing their behavior, modifying the $R_0$. Then the actual lockdown happens, and the $R_0$ is modified again. What does this plot look like?</p>
<div class="highlight"><pre><span></span><code><span class="n">model3</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch_soft</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model3</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rsoft</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model3</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rnew</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">deaths_per_day3</span> <span class="o">=</span> <span class="n">compute_deaths</span><span class="p">(</span><span class="n">model3</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;kx--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hard Only&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day3</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;r.--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Two Stage&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deaths Per Day&quot;</span><span class="p">)</span>

<span class="n">axs2</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">))}</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lock Down&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft Lockdown&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lockdown+Mean&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft Lockdown+Mean&quot;</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Two stage" src="https://william-dawson.github.io/assets/pand/output_18_0.png"></p>
<p>Indeed in this two stage model the deaths have been reduced. However, we don't really see much other evidence that something has happened, as the peak didn't move all the way back to the soft lockdown + mean location. We can repeat this study once more, but this time using a lower value of $R_0$ for the soft lockdown.</p>
<div class="highlight"><pre><span></span><code><span class="n">rsoft2</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">model4</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cases</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch_soft</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">model4</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rsoft2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">switch</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cases</span><span class="p">)):</span>
    <span class="n">model4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model4</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">rnew</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">deaths_per_day4</span> <span class="o">=</span> <span class="n">compute_deaths</span><span class="p">(</span><span class="n">model4</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;kx--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hard Only&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">deaths_per_day4</span><span class="p">[:</span><span class="n">total_days</span><span class="p">],</span> <span class="s1">&#39;r.--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Two Stage&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Deaths Per Day&quot;</span><span class="p">)</span>

<span class="n">axs2</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_days</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_days</span><span class="o">/</span><span class="mi">6</span><span class="p">))}</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lock Down&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft2 Lockdown&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lockdown+Mean&quot;</span>
<span class="n">ticks</span><span class="p">[</span><span class="n">switch_soft</span> <span class="o">+</span> <span class="n">mean</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Soft2 Lockdown+Mean&quot;</span>

<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">axs2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>

<p><img alt="Lower R0" src="https://william-dawson.github.io/assets/pand/output_21_0.png"></p>
<p>In this case, the lockdown peak has shifted much further back. So from this exercise, what we have (maybe?) learned, is that: 1) everyone's voluntary social distancing may help quite a bit, even if that alone is not enough ;
2) depending on how impactful it is, we may be able to see it in a shifted peak, but this is not guaranteed.</p>
        </section>

        <br><br><br>

 <!--        <footer>
          <div class="adjust-width">
            <div id="author-block" class="w3-light-grey w3-border">
              <div id="author-info">
                <a href=""><img style="width: 60px; height: 60px;" src="" onerror="this.src='images/avatar.png'" alt="Avatar"></a>
                <div style="margin-left: 20px; margin-top: 15px;">
                  <a href=""><span id="author-name" class="w3-hover-text-dark-grey">William Dawson</span></a>
                  <p id="author-story"></p>
                </div>
              </div>
            </div>
          </div>

          <br><br><br>

          <p style="font-size:10pt; font-style: italic;">Did you like this article? Share it with your friends!</p>
          <div id="share" class="share">
            <a href="http://www.facebook.com/sharer.php?u=https%3A//william-dawson.github.io/playing-with-pandemic-models.html&amp;t=william-dawson.github.io%3A%20Playing%20with%20Pandemic%20Models" target="_blank" class="w3-btn w3-indigo">
              <i class="fa fa-facebook"></i> <span>Facebook</span>
            </a>
            <a href="http://twitter.com/share?url=https%3A//william-dawson.github.io/playing-with-pandemic-models.html&amp;text=william-dawson.github.io%3A%20Playing%20with%20Pandemic%20Models" target="_blank" class="w3-btn w3-blue">
              <i class="fa fa-twitter"></i> <span>Twitter</span>
            </a>
            <a href="https://plus.google.com/share?url=https%3A//william-dawson.github.io/playing-with-pandemic-models.html" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="w3-btn w3-red">
              <i class="fa fa-google-plus"></i> <span>Google</span>
            </a>
          </div>

          <br><br><br>



        </footer> -->
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>&copy;  William Dawson  | <a href="https://william-dawson.github.io/feeds/all.atom.xml">Atom feed <i class="fa fa-rss" aria-hidden="true"></i></a></span>
      </div>
    </footer>



  </body>
</html>